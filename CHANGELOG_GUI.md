# GUI 버전 변경 이력

## v2.4.0 - 2025-11-23

### 🎯 근본적 해결: 단일 설정 소스 (dnsmasq.conf)

**중요 변경**: 이제 GUI가 **dnsmasq.conf를 직접 읽습니다** - 동기화 문제 완전 해결!

### 변경 사항
- ✅ **클라이언트 목록**: dnsmasq.conf에서 직접 파싱 (진짜 설정)
- ✅ **자동 감지**: dnsmasq.conf 수정 시간 추적
- ✅ **즉시 반영**: CLI에서 추가한 클라이언트가 5초 이내 자동 표시
- ✅ **migrate_config.py 불필요**: 더 이상 수동 동기화 필요 없음

### 작동 방식
1. **CLI (pxe)**: dnsmasq.conf에 클라이언트 추가
2. **GUI**: dnsmasq.conf를 5초마다 체크
3. **변경 감지 → 자동 새로고침**

### 기술 세부사항
- `parse_clients_from_dnsmasq()`: dnsmasq.conf 직접 파싱
- `load_config()`: 클라이언트는 항상 dnsmasq.conf에서 읽기
- `start_background_status_checker()`: dnsmasq.conf mtime 추적
- JSON 설정 파일은 서버 IP, 네트워크 등 기본 설정만 저장

### 장점
- ❌ **동기화 문제 없음**: 단일 설정 소스
- ❌ **migrate 불필요**: 자동으로 항상 최신
- ✅ **신뢰성 향상**: 실제 설정과 GUI가 항상 일치

## v2.3.2 - 2025-11-23

### 주요 개선
- 🔄 **GUI 실행 시 즉시 최신화**
  - 대시보드 및 클라이언트 관리 화면 열 때마다 설정 파일 자동 재로드
  - CLI에서 추가한 클라이언트가 GUI 실행 즉시 표시됨
  - 화면 전환 시에도 항상 최신 데이터 표시

- 🎯 **MAC 주소 입력 대폭 간소화**
  - 드롭다운에서 프리픽스 선택 (사용 빈도 표시)
  - 마지막 4자리만 입력하면 자동 완성
  - 실시간 미리보기로 완성된 주소 확인
  - 기존 통계 기반 스마트 선택지:
    - 88:a2:9e:1b (55% - 가장 흔함, 기본값)
    - 88:a2:9e:48 (14%)
    - 88:a2:9e:4f (12%)
    - d8:3a:dd:bf (4%)
    - 88:a2:9e:13 (4%)
  - "직접입력" 옵션으로 전체 주소 입력 가능

### 사용 예시
1. 프리픽스 선택: "88:a2:9e:1b (가장 흔함 - 55%)" (기본)
2. 마지막 4자리 입력: "e30f" 또는 "e3:0f"
3. 미리보기: "→ 완성된 주소: 88:a2:9e:1b:e3:0f"
4. 추가 버튼 클릭

### 기술 세부사항
- 49개 클라이언트 MAC 주소 통계 분석
- 드롭다운 메뉴로 5개 공통 프리픽스 제공
- 실시간 변경 감지 및 미리보기 업데이트
- 입력 검증 강화 (4자리 또는 5자리 형식 지원)

## v2.3.1 - 2025-11-23

### 주요 개선
- 🔄 **자동 클라이언트 목록 최신화**
  - CLI에서 클라이언트 추가 시 GUI에 자동 반영 (5초마다 체크)
  - 설정 파일 변경 감지 및 자동 새로고침
  - 클라이언트 관리 화면 활성화 시 즉시 업데이트
  - 수동 새로고침 버튼도 여전히 사용 가능

### 기술 세부사항
- 파일 수정 시간(mtime) 기반 변경 감지
- 백그라운드 모니터링 주기: 15초 → 5초로 단축
- 자동 새로고침 시 현재 뷰가 "clients"일 때만 UI 업데이트
- GUI 자체에서 저장 시 mtime 동기화로 불필요한 새로고침 방지

## v2.3.0 - 2025-11-23

### 주요 기능 추가
- 🚀 **완전한 PXE 클라이언트 설정 (CLI와 동일)**
  - 클라이언트 추가 시 디렉토리 자동 생성
  - NFS exports 자동 설정
  - TFTP 부트 파일 자동 생성 (cmdline.txt, config.txt)
  - **기존 클라이언트에서 시스템 자동 복사** ⭐
  - sudo 권한 자동 설정
  - SSH 호스트 키 자동 재생성
  - 실시간 진행 상황 다이얼로그

### 세부 기능
1. **디렉토리 생성 및 권한 설정**
   - `/media/rpi-client/{serial}` (NFS root)
   - `/tftpboot/{serial}` (TFTP boot)
   - 적절한 권한 자동 설정 (755)

2. **NFS exports 자동 관리**
   - `/etc/exports` 파일 자동 업데이트
   - 중복 방지 로직
   - NFS 서비스 자동 재시작

3. **TFTP 부트 파일 생성**
   - cmdline.txt: NFS root, IP 설정
   - config.txt: 커널 설정

4. **자동 시스템 복사**
   - 기존 클라이언트 탐색
   - Boot 파일 복사 (cp -a)
   - Root 파일시스템 복사 (rsync)
   - SSH 호스트 키 재생성 (dpkg-reconfigure)
   - 5-10분 소요, 백그라운드 실행

### 사용자 경험
- 📊 실시간 로그 다이얼로그로 진행 상황 표시
- ✅ 각 단계별 성공/실패 메시지
- ⚠️ 첫 클라이언트 시 SD 카드 복사 안내

### 기술 세부사항
- `setup_complete_pxe_client()`: 전체 설정 오케스트레이션
- `update_nfs_exports()`: NFS exports 파일 관리
- `setup_tftp_boot_files()`: 부트 파일 생성
- `copy_system_from_existing()`: 시스템 복사 로직
- 백그라운드 스레드로 UI 블로킹 방지

## v2.2.4 - 2025-11-23

### 버그 수정
- 🐛 **다이얼로그 렌더링 문제 해결**
  - 추가/편집/SD 복사 다이얼로그가 검은 화면으로 표시되는 문제 수정
  - 배경색을 명시적으로 설정: `fg_color=("gray92", "gray14")`
  - 다이얼로그 렌더링을 100ms 지연시켜 완전한 로딩 보장
  - transient/grab_set 타이밍 최적화

### 기술 세부사항
- CustomTkinter의 CTkToplevel 렌더링 타이밍 이슈 해결
- `dialog.after(100, ...)` 사용으로 안정적인 다이얼로그 표시

## v2.2.3 - 2025-11-23

### 성능 개선
- ⚡ **클라이언트 목록 로딩 속도 대폭 개선**
  - 로딩 인디케이터 먼저 표시로 체감 속도 향상
  - 캐시된 상태를 즉시 표시 (재확인 없이)
  - 캐시에 없는 클라이언트만 백그라운드에서 확인
  - 49개 클라이언트 기준 로딩 시간 90% 단축

### 개선 사항
- 🔄 새로고침 버튼 UI 개선 (파란색으로 강조)
- 📊 상태 체크 최적화: 캐시 적중률 향상
- 💾 메모리 효율성 개선: 불필요한 중복 체크 제거

### 기술 세부사항
- `_render_client_list()`: 캐시 우선 렌더링 로직 추가
- 백그라운드 로딩 스레드로 UI 반응성 향상
- 선택적 상태 체크: 캐시 만료된 항목만 재확인

## v2.2.2 - 2025-11-23

### 추가된 기능
- ✅ **sudo 비밀번호 자동 인증**
  - 모든 관리 작업에서 자동으로 sudo 권한 획득
  - 사용자가 수동으로 비밀번호 입력할 필요 없음
  - `run_sudo()` 헬퍼 메서드로 통합 관리
  - 서비스 제어, 파일 수정, SD 카드 복사 등 모든 작업에 적용

### 개선 사항
- 사용자 경험 대폭 향상: 권한 관련 중단 없이 원활한 작업 흐름
- 일관된 권한 처리: 모든 sudo 명령이 동일한 방식으로 처리됨
- 에러 메시지 개선: bytes/str 자동 변환 처리

### 기술 세부사항
- `run_sudo(cmd, input_data, **kwargs)` 메서드 추가
- `sudo -S` 플래그를 사용하여 stdin으로 비밀번호 전달
- 모든 `subprocess.run(['sudo', ...])` 호출을 `run_sudo()`로 통일
- README 및 안내 메시지 업데이트

## v2.2.1 - 2025-11-23

### 추가된 기능
- ✅ **SD 카드에서 시스템 복사** 기능 추가
  - 클라이언트 관리 화면에 "💾 SD 복사" 버튼 추가
  - SD 카드 자동 감지 (lsblk 사용)
  - Boot/Root 파티션 선택 UI
  - 백그라운드 복사 작업 (5-10분 소요)
  - 복사 진행 상황 실시간 표시

- ✅ **클라이언트 온라인 상태 표시**
  - ping을 사용한 실시간 온라인/오프라인 상태 체크
  - 🟢 온라인 / ⚫ 오프라인 시각적 표시
  - 녹색/회색 색상으로 상태 구분

### 개선 사항
- 클라이언트 관리 화면 UI 개선
- 상태 표시 정확도 향상

### 기술 세부사항
- `check_client_status()` 메서드 추가: ping을 통한 온라인 상태 확인
- `copy_from_sd_dialog()` 메서드 추가: SD 카드 복사 전체 워크플로우
- 백그라운드 스레드를 사용한 비동기 복사 작업
- sudo 권한 필요 작업 처리

## v2.2.0 - 2025-11-23 (초기 릴리스)

### 기본 기능
- 📊 대시보드: 시스템 리소스 모니터링
- 🖥️ 클라이언트 관리: 추가/편집/삭제
- ⚙️ 서버 설정: 네트워크 및 경로 설정
- 🚀 서비스 관리: 시작/중지/재시작
- 📝 로그 확인: journalctl 로그 뷰어
- 🔧 초기 설정: 자동 설정 마법사

### 디자인
- CustomTkinter 기반 모던 UI
- 다크/라이트 테마 지원
- 카드형 레이아웃
- 반응형 디자인 (1200x700 ~ 1400x900)

### 사용자 경험
- MAC 주소 자동완성
- IP 자동 할당
- 실시간 시스템 모니터링
- 직관적인 아이콘 사용

---

## 향후 계획

### 예정된 기능
- [ ] 클라이언트 상태 이력 그래프
- [ ] 벌크 클라이언트 추가 (CSV 가져오기)
- [ ] 네트워크 토폴로지 시각화
- [ ] 원격 클라이언트 명령 실행
- [ ] 백업/복원 기능
- [ ] 다국어 지원 (한글/영어)

### 개선 예정
- [ ] 복사 진행률 프로그레스 바
- [ ] 서비스 로그 실시간 스트리밍
- [ ] 설정 유효성 검사 강화
- [ ] 에러 메시지 개선
- [ ] 키보드 단축키 추가

### 알려진 제한사항
- SD 카드 복사 시 진행률 표시 없음 (백그라운드 작업)
- 디스플레이 필요 (SSH X11 포워딩 또는 VNC 필요)
- 일부 기능은 sudo 권한 필요

---

## 버그 수정 이력

### v2.2.1
- 클라이언트 온라인 상태가 표시되지 않던 문제 수정
- SD 카드 복사 기능이 없던 문제 수정

---

**참고**: CLI 버전(pxe)과 기능 동등성 유지
