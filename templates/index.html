<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RPI PXE Manager</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
</head>
<body>
    <div class="container">
        <header>
            <h1>Raspberry Pi PXE Manager</h1>
            <div class="server-status">
                <span id="server-ip">서버 IP: 확인중...</span>
                <span id="dhcp-range">DHCP 범위: 확인중...</span>
                <span id="interface">인터페이스: 확인중...</span>
            </div>
        </header>

        <div class="main-content">
            <div class="panel services-panel">
                <h2>서비스 상태</h2>
                <div class="service-status">
                    <div class="service-item">
                        <span>DNSMASQ</span>
                        <span class="status-indicator" id="dnsmasq-status"></span>
                    </div>
                    <div class="service-item">
                        <span>NFS Server</span>
                        <span class="status-indicator" id="nfs-status"></span>
                    </div>
                </div>
                
                <h3>시스템 리소스</h3>
                <div class="resource-stats">
                    <div class="stat-item">
                        <label>CPU:</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="cpu-usage"></div>
                        </div>
                        <span id="cpu-percent">0%</span>
                    </div>
                    <div class="stat-item">
                        <label>메모리:</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="memory-usage"></div>
                        </div>
                        <span id="memory-percent">0%</span>
                    </div>
                    <div class="stat-item">
                        <label>디스크:</label>
                        <div class="progress-bar">
                            <div class="progress-fill" id="disk-usage"></div>
                        </div>
                        <span id="disk-percent">0%</span>
                    </div>
                </div>
            </div>

            <div class="panel actions-panel">
                <h2>서버 설정</h2>
                <button id="setup-server-btn" class="primary-btn">
                    <span class="btn-icon">⚙️</span>
                    서버 초기 설정
                </button>
                <button id="config-btn" class="secondary-btn">
                    <span class="btn-icon">📝</span>
                    설정 변경
                </button>
                
                <h2>클라이언트 관리</h2>
                <button id="setup-client-btn" class="primary-btn">
                    <span class="btn-icon">➕</span>
                    첫 클라이언트 설정
                </button>
                <button id="create-client-btn" class="primary-btn">
                    <span class="btn-icon">📋</span>
                    새 클라이언트 추가
                </button>
                
                <h2>로그 확인</h2>
                <button id="view-dnsmasq-log" class="secondary-btn">
                    <span class="btn-icon">📄</span>
                    DNSMASQ 로그
                </button>
                <button id="view-nfs-log" class="secondary-btn">
                    <span class="btn-icon">📄</span>
                    NFS 로그
                </button>
            </div>

            <div class="panel clients-panel">
                <h2>연결된 클라이언트</h2>
                <div id="clients-list" class="clients-list">
                    <div class="loading">클라이언트 정보 로딩중...</div>
                </div>
            </div>
        </div>

        <div class="console-panel">
            <div class="console-header">
                <h3>실행 로그</h3>
                <button id="clear-console" class="small-btn">지우기</button>
            </div>
            <div id="console-output" class="console-output"></div>
        </div>
    </div>

    <!-- 첫 클라이언트 설정 모달 -->
    <div id="setup-client-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>첫 클라이언트 설정</h2>
            <form id="setup-client-form">
                <div class="form-group">
                    <label>Raspberry Pi 시리얼 번호:</label>
                    <input type="text" id="client-serial" required placeholder="예: 10000000abcdef12">
                    <small>SD카드의 /boot/serial 파일에서 확인 가능</small>
                </div>
                <div class="form-group">
                    <label>SD 카드 선택:</label>
                    <select id="sd-card-select" required>
                        <option value="">SD 카드 검색중...</option>
                    </select>
                    <button type="button" id="refresh-sdcards" class="small-btn">새로고침</button>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">설정 시작</button>
                    <button type="button" class="secondary-btn cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 새 클라이언트 추가 모달 -->
    <div id="create-client-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>새 클라이언트 추가</h2>
            <form id="create-client-form">
                <div class="form-group">
                    <label>복사할 소스 클라이언트:</label>
                    <select id="source-client-select" required>
                        <option value="">클라이언트 선택...</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>새 Raspberry Pi 시리얼 번호:</label>
                    <input type="text" id="new-client-serial" required placeholder="예: 10000000abcdef13">
                </div>
                <div class="form-group">
                    <label>MAC 주소 (선택사항):</label>
                    <input type="text" id="new-client-mac" placeholder="예: dc:a6:32:xx:xx:xx">
                    <small>DHCP 예약을 원하는 경우에만 입력</small>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">클라이언트 생성</button>
                    <button type="button" class="secondary-btn cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 설정 변경 모달 -->
    <div id="config-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>서버 설정</h2>
            <form id="config-form">
                <div class="form-group">
                    <label>서버 IP 주소:</label>
                    <input type="text" id="config-server-ip" required>
                </div>
                <div class="form-group">
                    <label>DHCP 시작 주소:</label>
                    <input type="text" id="config-dhcp-start" required>
                </div>
                <div class="form-group">
                    <label>DHCP 종료 주소:</label>
                    <input type="text" id="config-dhcp-end" required>
                </div>
                <div class="form-group">
                    <label>네트워크 인터페이스:</label>
                    <input type="text" id="config-interface" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="primary-btn">설정 저장</button>
                    <button type="button" class="secondary-btn cancel-btn">취소</button>
                </div>
            </form>
        </div>
    </div>

    <!-- 로그 뷰어 모달 -->
    <div id="log-modal" class="modal">
        <div class="modal-content large">
            <span class="close">&times;</span>
            <h2 id="log-title">서비스 로그</h2>
            <div class="log-viewer" id="log-content"></div>
        </div>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>